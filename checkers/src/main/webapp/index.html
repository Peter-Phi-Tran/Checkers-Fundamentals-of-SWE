<html>

    <head>
        <link rel="stylesheet" href="styles.css">
    </head>

    <div id="new_account">
		<!--Signup screen logo-->
    	<h1>Create New Account</h1>
		<!--Signup screen logo-->
		
		    <img src="https://cdn.discordapp.com/attachments/1344205333568163844/1356392100383559841/logopng.png?ex=67ec6615&is=67eb1495&hm=411f67f79cbf800bd043d62774b59ad9ba6ed38c388e92546480d4b2b8588084&" alt="Super Fancy Checkers Logo" style="width: 200px; height: 200px; display: block; margin: auto;">
		    <body style="text-align: center; height: 100vh; display: table; width: 100%;">
		
				<div style="margin-bottom: 10px;">
					<label for="username">Enter new username: </label>
					<input type="text" id="username" name="username" placeholder="Enter new username" style="border-radius: 100px;">
				  </div>
				  <div style="margin-bottom: 10px;">
					<label for="password">Enter new password: </label>
					<input type="password" id="password" name="password" placeholder="Enter new password" style="border-radius: 100px;">
				  </div>
			
			<button type="submit" style="display: block; margin: 3 auto;">Register</button>

			<!--Button to return to login from sign up page-->
			<button id ="back-to-login">Login</button>
		
		    </body>
		
			
    </div>
	<div id="login">
		<h1>Login</h1> <!--before create new account-->
		<!--Login screen logo DONE-->
		<img src="https://cdn.discordapp.com/attachments/1344205333568163844/1356392100383559841/logopng.png?ex=67ec6615&is=67eb1495&hm=411f67f79cbf800bd043d62774b59ad9ba6ed38c388e92546480d4b2b8588084&" alt="Super Fancy Checkers Logo" style="width: 200px; height: 200px; display: block; margin: auto;">
		<!-- username login box-->
		<div style="margin-bottom: 10px;">
		<label for = "login-username">Username: </label>
		<input type = "text" id ="login-username" name = "login-username" placeholder = "Enter Username"style="border-radius: 100px;">
		</div>
		<!-- password login box-->
		<div style="margin-bottom: 10px;">
		<label for = "login-password">Password: </label>
		<input type ="text" style="border-radius: 100px;" placeholder="Enter Password" >
		</div>
		<!-- submit button-->
		 <button type = "submit" style="display: block; margin: 3 auto;">Login</button>

		 <!--Show signup screen-->
		 <button id = "show-signup">Sign Up</button>

		 <script>
			// (On Click) Sign up screen appear, login disappear
			document.getElementById("show-signup").onclick = function() {
            document.getElementById("login").style.display = "none";
            document.getElementById("new_account").style.display = "block";
                  };

           // (On Click) Login screen appear, sign up disappear
            document.getElementById("back-to-login").onclick = function() {
            document.getElementById("new_account").style.display = "none";
            document.getElementById("login").style.display = "block";
             	};
		 </script>
		
	</div>
    <div id="join_game">
        <div class="lobby_lists_container" style="margin: 20px auto"> <!-- idk why but this wasn't updating in styles.css -->
            <h2>Welcome back {playerID} Have fun in the lobby :D</h2>
            <p>Current players: 3/48</p>
            <div class="lobby_lists" style="border-radius: 2em; border: 1px solid">
                <ol id="lobby_list_items">
                    <!-- Dynamically Created Elements -->
        
                    <!-- EXAMPLE:
                    <li class="player">
                        <p id="#UID002"> Player 2 - {ELO} <span class="status busy"></span></p>
                        <button><a id="btn1-UID002" type="button" href="" onclick="req_challenge(1,2)">Challenge</a></button>
                        <button><a id="btn2-UID002" type="button" href="">View Match</a></button>
                    </li> -->
                </ol>
            </div>
        
            <button>
                <a id="CURRENT_SESSION_JQ" type="button" onclick="match_making({'id':1,'name':'bob','elo':1200})">
                    Match Making
                </a>
            </button>
            <button>
                <a id="CURRENT_SESSION_BOT" type="button">
                    Request Bot
                </a>
            </button>
            <button>
                <a id="CURRENT_SESSION_BOTvsBOT" type="button">
                    Watch Bot Vs Bot
                </a></button>
        </div>
    </div>
    <div id="game_display">
    game display
    </div>
    <div class="summary">
		<h1>Leaderboard</h1>
		<table>
			<thead>
				<tr>
					<th>Rank</th>
					<th>Player</th>
					<th>Elo</th>
					<th>Games Won</th>
					<th>Games Lost</th>
					<th>Total Number of Games</th>
				</tr>
			</thead>
		<!-- Example data, these will be cleared and filled with JSON through a JS script -->
			<tbody>
				<tr>
					<td>1</td>
					<td>Player 1</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>2</td>
					<td>Player 2</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>3</td>
					<td>Player 3</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>4</td>
					<td>Player 4</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>5</td>
					<td>Player 5</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>6</td>
					<td>Player 6</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>7</td>
					<td>Player 7</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>8</td>
					<td>Player 8</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>9</td>
					<td>Player9</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
				<tr>
					<td>10</td>
					<td>Player 10</td>
					<td>0</td>
					<td>00</td>
					<td>000</td>
					<td>0000</td>
				</tr>
			</tbody>
		</table>
		 <!--- <p class= "caption"> Top 10 players.</p> -->
		<!-- <a href="../index.html" class="button">Back to Home</a> -->
		<script src="summary.js"></script>	
	</div>

    <div id="stuff">
     <input type="button" value="Send Something" onclick="msg()">
      <label for="tbox">Received</label>
      <textarea id="tbox" name="tbox" rows="4" cols="50">
     </textarea>
    </div>
</html>
<script>
    // each of the 'divs' in the html page should have attributes to allow them to be hidden.
    // the page manager should send a small json message, that tells which of these are hidden
    // and which are visible when there is a change
    // something like "{"display_new_account":t,"display_join_game":f,"display_game_display:f,"display_summary":f}"


    // a reminder.  we want to create one websocket connection, and use if, basically forever.
    // or until the user decides to go to another page.
    // this requires everything to load from this page.

    var connection = null;

    var serverUrl;
    serverUrl = "ws://" + window.location.hostname + ":" + (parseInt(location.port) + 100);
    connection = new WebSocket(serverUrl);

    connection.onopen = function (evt) {
        console.log("open");
    }

    connection.onclose = function (evt) {
        console.log("close");
    }

    connection.onmessage = (event) => {
        const users = JSON.parse(event.data);
        const listEl = document.getElementById("lobby_list_items");


        for (const userKey in users) {
            const user = users[userKey];
            console.log(user); 
            const li = document.createElement("li");
            li.className = "player"; 

            // create player info
            const para = document.createElement("p")
            para.innerText = `${user.username} (ID: ${parseInt(user)})`;
            para.style.fontSize = "17px"; // Set font size for the player info
            para.id = `UID${parseInt(user)}`; 

            const statusSpan = document.createElement("span");
            statusSpan.className = "status free"; 

            para.appendChild(statusSpan); 

            // Create buttons button
            const challenge_btn = document.createElement("button");
            const challenge_btn_link = document.createElement("a");

            challenge_btn_link.id = `btn1-${parseInt(user)}`; 
            challenge_btn_link.type = "button";
            challenge_btn_link.href = "#";
            challenge_btn_link.innerText = "Challenge";

            challenge_btn_link.onclick = function() { 
                req_challenge(1, parseInt(user)); 
                return false; 
            };
            
            const view_btn = document.createElement("button");
            const view_btn_link = document.createElement("a");
            
            view_btn_link.id = `btn2-${parseInt(user)}`;
            view_btn_link.type = "button";
            view_btn_link.href = "#";
            view_btn_link.innerText = "View Match"; 
            
            challenge_btn.appendChild(challenge_btn_link); 
            view_btn.appendChild(view_btn_link); 
            
            //send info to server using socket.send, do have to update the Id and im not sure if you guys prefer sending the whole list or just 1 player info at a time

            challenge_btn.addEventListener("click", () => {
                const payload = {
                    userID: user.ID,
                    action: "do_something",
                    username: user.username,
                };
                socket.send(JSON.stringify(payload));
                console.log("Sent:", payload);
            });
            
            li.appendChild(para); 
            li.appendChild(challenge_btn);
            li.appendChild(view_btn);
            listEl.appendChild(li);
        }
    };
    /**
     * [This function take in player id 1, player id 2 and then send back to server to signal a challenge request]
     */
    function req_challenge(id1, id2) {
        //do same handling here 
        alert(`${id1} request challenge ${id2}`);
    }

    /**
     * [This function take in player id 1, player id 2 and then send back to server to signal a view match request]
     */
    function req_viewmatch(id1, id2) {
        //do same handling here , playerid1 want to view playerid2 match

        alert(`${id1} request view ${id2}`);
    }

    /**
     * [This function take in current client and send signal to server indicating bot request]
     */
    function req_bot(id1) {
        alert(`${id1} request bot`);
    }

    /**
     * [This function take in current client json and signal to server indicating matchmaking request]
     */
    function match_making(player1) {
        const message = {
            'message_type': 'match_making',
            'player': {
                'id1': player1.id1,
                'name': player1.name,
                'elo': player1.elo
            }
        };
        alert(JSON.stringify(message, null, 2)); // Converts the object to a readable JSON string
    }

    class UserEvent {
        msg;
    }

    function msg() {
        console.log("button clicked");
        U = new UserEvent();
        U.msg="i pushed a button";
        connection.send(JSON.stringify(U));
        console.log(JSON.stringify(U))
    }

	function summary(/*void*/) {
    /*
     * Fetches and displays player ranking data in the summary table.
     *
     * This function retrieves JSON data for:
     * - The current player, identified via a session UUID.
     * - The top 10 ranked players.
     *
     * The data is retrieved using:
     * - `retrieveUserJson(uuid)`: Fetches the current player's data.
     * - `retrieveTopTenJson()`: Fetches the top 10 ranked players.
     *
     * The retrieved data is then written to the HTML table inside the summary div.
     *
     * TODO:
     * - Implement a method to obtain the session UUID to call `retrieveUserJson(uuid)`.
     * - Handle potential errors when fetching data.
     * - Ensure proper table structure for displaying the data.
     */
    
    // playerData = retrieveUserJson();
    // globalData = retrieveTopTenJson();

    // Write top ten to table
    // Write user to table
    return;
}
</script>
